[{"content":"使用PyPDF4在PDF文件加入浮水印(watermark)\nPDF(Portable Document Format)是工作上常會用到的一種文件格式，有較不容易修改、傳輸方便、設備相容性和印刷品質較佳等優點。一般我們開發的軟體要自動發報告、帳單或收據給客戶，也都會優先選擇PDF為主要格式。\n合併PDF是目前加入浮水印的一種簡便方法，當浮水印樣式和內容固定的情況下開發會較為單純。本文以Pyhton的PyPDF4套件為例，雖然PyPDF4和PyPDF2不完全兼容，但此範例中所導入的函示方法和PyPDF2一樣，將套件名稱改掉後程式碼可以互相通用。\n用來示範的兩份PDF檔案，original_doc.pdf 和 watermark.pdf，程式會將浮水印合併到 original_doc.pdf 每一頁。\n   original_doc.pdf watermark.pdf          套件安裝 首先，安裝最新版的PyPDF4 (以下指令基於python3):\npip3 install PyPDF4\r合併浮水印 merge_watermark()是實現合併浮水印的方法，每當合併完一頁PDF浮水印就透過writer實例立刻輸出。\nfrom PyPDF4 import PdfFileWriter, PdfFileReader def merge_watermark(input_pdf, output_pdf, watermark): \u0026#34;\u0026#34;\u0026#34; Merge watermark to target PDF \u0026#34;\u0026#34;\u0026#34; watermark_obj = PdfFileReader(watermark) watermark_page = watermark_obj.getPage(0) pdf_reader = PdfFileReader(input_pdf) pdf_writer = PdfFileWriter() # Add watermark to each page  for page_num in range(pdf_reader.getNumPages()): page = pdf_reader.getPage(page_num) page.mergePage(watermark_page) pdf_writer.addPage(page) with open(output_pdf, \u0026#39;wb\u0026#39;) as f: pdf_writer.write(f) ArgumentParser 程式就是要能夠帶參數才可以方便使用。使用ArgumentParser解析並傳遞參數給Python程式碼。\n          -i --input 參數指定要被加入浮水印的PDF檔案路徑   -o --output 參數指定檔案輸出路徑，指定的路徑資料夾不存在就創建新的；但如果不指定輸出路徑，預設就會將檔案命名\u0026lt;原PDF檔名\u0026gt;-watermarked.pdf並輸出至原始PDF所在的資料夾。   -w --watermark 參數指定浮水印PDF檔案路徑    def parse_arguments(): \u0026#34;\u0026#34;\u0026#34; Parse command line arguments \u0026#34;\u0026#34;\u0026#34; parser = ArgumentParser(description=\u0026#34;Add watermarks to PDF in path\u0026#34;) parser.add_argument(\u0026#34;-i\u0026#34;, \u0026#34;--input\u0026#34;, help=\u0026#34;Path to input PDF\u0026#34;, required=True, type=str) parser.add_argument(\u0026#34;-o\u0026#34;, \u0026#34;--output\u0026#34;, help=\u0026#34;Path to output PDF\u0026#34;) parser.add_argument(\u0026#34;-w\u0026#34;, \u0026#34;--watermark\u0026#34;, help=\u0026#34;Path to watermark PDF\u0026#34;, required=True, type=str) return parser.parse_args() def main(): args = parse_arguments() source_pdf = os.path.abspath(args.input) source_dir = os.path.dirname(source_pdf) fname, f_ext = os.path.splitext(os.path.basename(source_pdf)) if args.output is None: ofname = os.path.join(source_dir, \u0026#39;{}{}{}\u0026#39;.format(fname, \u0026#34;-watermarked\u0026#34;, f_ext)) else: ofname = os.path.abspath(args.output) output_dir = os.path.dirname(ofname) try: if not os.path.exists(output_dir): os.makedirs(output_dir) except EnvironmentError: sys.exit(\u0026#34;Unable to create folder: \u0026#34; + output_dir) if os.path.isfile(source_pdf): merge_watermark( input_pdf = source_pdf, output_pdf = ofname, watermark = args.watermark ) else: sys.exit(\u0026#34;\\nPDF file {}not exists!\\n\u0026#34;.format(source_pdf)) if __name__ == \u0026#39;__main__\u0026#39;: import os import sys from argparse import ArgumentParser main() \n將程式儲存命名為watermark.py就可以來執行看看。\npython3 watermark.py -i original_doc.pdf -w watermark.pdf 輸出結果請見下圖。\n   original_doc-watermarked.pdf         以本人實際開發經驗來說，如果浮水印本來就屬於PDF該有的內容，應該在一開始撰寫模板的時候就考慮進去，到後面使用合併的方式其實都算是最後手段了。\nReference  https://github.com/claird/PyPDF4 A Complete Guide on How to Work With a PDF in Python  ","permalink":"https://rcguo.github.io/posts/2020/python_watermark/","summary":"使用PyPDF4在PDF文件加入浮水印(watermark)\nPDF(Portable Document Format)是工作上常會用到的一種文件格式，有較不容易修改、傳輸方便、設備相容性和印刷品質較佳等優點。一般我們開發的軟體要自動發報告、帳單或收據給客戶，也都會優先選擇PDF為主要格式。\n合併PDF是目前加入浮水印的一種簡便方法，當浮水印樣式和內容固定的情況下開發會較為單純。本文以Pyhton的PyPDF4套件為例，雖然PyPDF4和PyPDF2不完全兼容，但此範例中所導入的函示方法和PyPDF2一樣，將套件名稱改掉後程式碼可以互相通用。\n用來示範的兩份PDF檔案，original_doc.pdf 和 watermark.pdf，程式會將浮水印合併到 original_doc.pdf 每一頁。\n   original_doc.pdf watermark.pdf          套件安裝 首先，安裝最新版的PyPDF4 (以下指令基於python3):\npip3 install PyPDF4\r合併浮水印 merge_watermark()是實現合併浮水印的方法，每當合併完一頁PDF浮水印就透過writer實例立刻輸出。\nfrom PyPDF4 import PdfFileWriter, PdfFileReader def merge_watermark(input_pdf, output_pdf, watermark): \u0026#34;\u0026#34;\u0026#34; Merge watermark to target PDF \u0026#34;\u0026#34;\u0026#34; watermark_obj = PdfFileReader(watermark) watermark_page = watermark_obj.getPage(0) pdf_reader = PdfFileReader(input_pdf) pdf_writer = PdfFileWriter() # Add watermark to each page  for page_num in range(pdf_reader.","title":"使用PyPDF4在PDF文件加入浮水印(watermark)"},{"content":"開發的時候曾經遇到一個情況，需要在 shell 執行程式時將 stderr 導向 console，但是不能顯示stdout 的訊息，且必須同時 stderr 和 stdout 記錄到 log 檔案。\n文件描述符 (file descriptor) 在 UNIX/Linux 系統中，是使用非負整數(0, 1, 2, \u0026hellip;)來表示文件描述符(file descriptor, fd)，用於標示系統中打開的文件和資源。 系統預設打開 0 (stdin), 1 (stdout), 2 (stderr)，也是我們平常常用到的描述符。\n接下來會將需求實作出來，並舉幾個例子以及需要注意的地方:\n 藉由ls一個不存在的檔案來測試，並將 stderr 訊息導向 error.log，我們cat檔案可以看到錯誤訊息:ls: cannot access foo.txt: No such file or directory。  ls foo.txt 2\u0026gt;error.log  將 stderr 導向 stdout，指令中 \u0026amp;(ampersand)符號是告訴shell我們把 fd 2 導向 fd 1 這個fd而不是一個檔案名稱。 在linux下，一切皆檔案，所以系統背後所做的事情是將 fd 1 複製給 fd 2。  ls foo.txt 2\u0026gt;\u0026amp;1  以下的指令先將 stdout 導向 error.log，所以之後 2\u0026gt;\u0026amp;1 重導向會將錯誤訊息寫入 syslog.log 中。 (一般1\u0026gt;syslog.log會省略1寫成＞error.log)  ls foo.txt 1\u0026gt;syslog.log 2\u0026gt;\u0026amp;1  這個指令和剛剛指令很像，要特別注意的是，有些人可能會理解成 「先把 stderr 導向 stdout，後面再把 stdout 導向 error.log，所以 stderr 和 stdout 都會寫入 syslog.log」。  ls foo.txt 2\u0026gt;\u0026amp;1 1\u0026gt;syslog.log 實際上則是 fd 2 複製原本的 fd 1 指向它目前指向的位置也就是 console ，之後 fd 1 會被導向到 syslog.log ，但 fd 2 所複製的副本不受影響，所以錯誤訊息會被印到 console ，stdout 會被存入檔案。\nTee 到這裡已經實作出需求的一半了，但是錯誤訊息尚未被存入檔案，這時候我們可以用 tee 將某個指令的標準輸出，導向、存入某個檔案中。\nls -l的輸出被導向 tee，並且複製到檔案 file.txt 以及下一個命令\n(圖片來源: https://zh.wikipedia.org/wiki/Tee)\n 可以看到 stderr 輸出到 console 並用管線將 console 內容傳給 tee 存入檔案。因此該指令也就能達成我們原本的需求。  ls foo.txt 2\u0026gt;\u0026amp;1 1\u0026gt;syslog.log | tee syslog.log Reference  Ampersands and File Descriptors in Bash 鳥哥的 Linux 私房菜 Wiki - tee  ","permalink":"https://rcguo.github.io/posts/2020/linux_shell_redirect_stderr_stdout/","summary":"開發的時候曾經遇到一個情況，需要在 shell 執行程式時將 stderr 導向 console，但是不能顯示stdout 的訊息，且必須同時 stderr 和 stdout 記錄到 log 檔案。\n文件描述符 (file descriptor) 在 UNIX/Linux 系統中，是使用非負整數(0, 1, 2, \u0026hellip;)來表示文件描述符(file descriptor, fd)，用於標示系統中打開的文件和資源。 系統預設打開 0 (stdin), 1 (stdout), 2 (stderr)，也是我們平常常用到的描述符。\n接下來會將需求實作出來，並舉幾個例子以及需要注意的地方:\n 藉由ls一個不存在的檔案來測試，並將 stderr 訊息導向 error.log，我們cat檔案可以看到錯誤訊息:ls: cannot access foo.txt: No such file or directory。  ls foo.txt 2\u0026gt;error.log  將 stderr 導向 stdout，指令中 \u0026amp;(ampersand)符號是告訴shell我們把 fd 2 導向 fd 1 這個fd而不是一個檔案名稱。 在linux下，一切皆檔案，所以系統背後所做的事情是將 fd 1 複製給 fd 2。  ls foo.txt 2\u0026gt;\u0026amp;1  以下的指令先將 stdout 導向 error.","title":"Linux Shell 重新導向: 將標準錯誤(stderr)輸出到螢幕和檔案"},{"content":"做為一名軟體工程師，工作也有幾年的時間了，一直都有紀錄和分享的想法，心裡卻擔心要分享的東西是不是太簡單了，或是不夠高大尚，老實說是我多慮了，對於現代人來說:\n 網路其實是人腦的延伸\n 寫程式寫到一半上網查個指令或程式碼片段，對工程師來說是家常便飯，你覺得簡單的東西人可能不覺得簡單。將知識消化的過程記錄下來，給了自己能回溯學習的機會，也給了其他人參考學習的來源。\n相信每個人一定都有一個最熟悉的「主」語言，雖然說語言只是完成事情的工具，但是隨著程式語言不斷演進和開發需求的不同，懂得越多意味著擁有更多選擇，能用不同方式來解決同樣的問題。\n 如果你只有槌子，看甚麼都像釘子\n 因此，持續學習不同程式語言或新知識對於工程師來說就是一項必備的能力，但不要以為看懂了就能記起來，除非你是記憶力的人，否則其實大部分人都需要時常複習和練習，才能把知識變成是自己的東西。\n做筆記 雖然市面上有許多種筆記軟體可供選擇，個人還是習慣使用文字檔寫個 Markdown 存在雲端，依照語言或項目做分類。當然，選擇自己慣用的方法即可。\n 筆記整理得多了，有時候也能幫助別人\n 例如，對某項技術比較生疏的同事，我就可以用15分鐘整理一份簡略版筆記讓他上手;想在小組內達成某個技術上的共識，也可以做一份簡報在小組會議的時候做分享。\n能夠教別人才是真的懂 常常發現自己縱使做了筆記，也實作了一些成果出來，但當要跟別人說明時卻又說不出個所以然、吚吚啊阿講不到核心重點，事實上是因為自己也不是很懂。\n 撰寫文章也是「刻意練習」的一種方式\n 撰寫文章是最簡單的刻意練習方式，但和作筆記不同。撰寫文章會刻意的將得到的知識重複檢視並加以消化，這個過程往往可以發現自己誤解或不甚了解之處。透過不斷重複這些步驟: 學習 -\u0026gt; 筆記 -\u0026gt; 組織成文章，記錄的資訊量愈大，我們就愈能理解自己關注的領域。\n","permalink":"https://rcguo.github.io/posts/2020/my_first_hugo_blog/","summary":"做為一名軟體工程師，工作也有幾年的時間了，一直都有紀錄和分享的想法，心裡卻擔心要分享的東西是不是太簡單了，或是不夠高大尚，老實說是我多慮了，對於現代人來說:\n 網路其實是人腦的延伸\n 寫程式寫到一半上網查個指令或程式碼片段，對工程師來說是家常便飯，你覺得簡單的東西人可能不覺得簡單。將知識消化的過程記錄下來，給了自己能回溯學習的機會，也給了其他人參考學習的來源。\n相信每個人一定都有一個最熟悉的「主」語言，雖然說語言只是完成事情的工具，但是隨著程式語言不斷演進和開發需求的不同，懂得越多意味著擁有更多選擇，能用不同方式來解決同樣的問題。\n 如果你只有槌子，看甚麼都像釘子\n 因此，持續學習不同程式語言或新知識對於工程師來說就是一項必備的能力，但不要以為看懂了就能記起來，除非你是記憶力的人，否則其實大部分人都需要時常複習和練習，才能把知識變成是自己的東西。\n做筆記 雖然市面上有許多種筆記軟體可供選擇，個人還是習慣使用文字檔寫個 Markdown 存在雲端，依照語言或項目做分類。當然，選擇自己慣用的方法即可。\n 筆記整理得多了，有時候也能幫助別人\n 例如，對某項技術比較生疏的同事，我就可以用15分鐘整理一份簡略版筆記讓他上手;想在小組內達成某個技術上的共識，也可以做一份簡報在小組會議的時候做分享。\n能夠教別人才是真的懂 常常發現自己縱使做了筆記，也實作了一些成果出來，但當要跟別人說明時卻又說不出個所以然、吚吚啊阿講不到核心重點，事實上是因為自己也不是很懂。\n 撰寫文章也是「刻意練習」的一種方式\n 撰寫文章是最簡單的刻意練習方式，但和作筆記不同。撰寫文章會刻意的將得到的知識重複檢視並加以消化，這個過程往往可以發現自己誤解或不甚了解之處。透過不斷重複這些步驟: 學習 -\u0026gt; 筆記 -\u0026gt; 組織成文章，記錄的資訊量愈大，我們就愈能理解自己關注的領域。","title":"寫部落格與分享"},{"content":"\r\r 在這個部落格裡，我會寫一些與程式語言、軟體架構和Web開發相關的技術筆記，以及我想分享的任何其他內容。歡迎來到這裡讀一兩篇文章並給點寶貴的意見!\n-RCGuo\n   ","permalink":"https://rcguo.github.io/about/","summary":"about","title":"About"}]